<html>
<head>
  <meta charset="UTF-8">
  <script src="https://lpcdn.lpsnmedia.net/webagent/client-SDK.min.js"></script>
</head>
<body onload="initSDK()">
<h1>Test Widget</h1>
<script>
    function initSDK(){
        try {
            lpTag.agentSDK.init({});

            //Event Receiver
            var lpEventReceiver = function(data)
                {
                    //const path = data.key;
                    //const value = data.newValue;
                    console.log("lpEventReceiver: " + JSON.stringify(data));
                    MapUrlParam();
                }
            
            //Error Handler
            var lpErrorHandler = function(err)
                {
                    if (err)
                    {
                        console.error("Error received at lpErrorHandler: ",err);
                    }
                };

            lpTag.agentSDK.bind('chatInfo.rtSessionId', lpEventReceiver, lpErrorHandler);
            lpTag.agentSDK.bind('agenInfo.employeeId', lpEventReceiver, lpErrorHandler);
        } catch (error) {
            console.error("Error at initSDK: ", error);
        }
    }
    
function MapUrlParam() {
    var sPageURL = window.location.search.substring(1);
    var sURLVariables = sPageURL.split('&');
    console.log(sPageURL);
    for (var i = 0; i < sURLVariables.length; i++) {
        var sParameterName = sURLVariables[i].split('=');
        console.log(sParameterName);
        if (sParameterName[0] === urlParam) {
            console.log(sParameterName[1]);
            return sParameterName[1];
        }
    }
}
</script>
</body>