<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LivePerson Custom Widget</title>
	<script src="https://lpcdn.lpsnmedia.net/webagent/client-SDK.min.js" type="text/javascript"></script>
</head>
<body>
 
    <h2>LivePerson Custom Widget</h2>
    <div id="conversation"></div>
 
    <script>
        // Ensure lpTag is available
        window.lpTag = window.lpTag || {};
        lpTag.agentSDK = lpTag.agentSDK || new window.lpTag.AgentSDK();
 
        // Subscribe to Agent Conversations
        function subscribeToAgentConversations() {
            const agentSDK = lpTag.agentSDK;
			
			agentSDK.init({});

            // Subscribe to real-time conversation updates
            agentSDK.bind(
                {
                    type: 'routing.agentUserSession',
                    skillId: '*', // Subscribe to all skills (use specific IDs if needed)
                },
                (data) => {
                    console.log("Conversation Data:", data);
                    document.getElementById("conversation").innerText = JSON.stringify(data, null, 2);
                },
                (error) => {
                    console.error("Subscription Error:", error);
                }
            );
        }
 
        // Initialize and subscribe
        document.addEventListener("DOMContentLoaded", function() {
            subscribeToAgentConversations();
        });
    </script>
 
</body>
</html>